import { execSync } from "node:child_process";

const mdNoteFlavors = {
    jsts: ["/*", "*/"],
    md: ["<!--", "-->"],
};

/**
 * @param {string} file
 * @param {keyof typeof mdNoteFlavors} flavor
 */
export const makeMdNote = (file, flavor) => `${mdNoteFlavors[flavor][0]}
    * This file was autogenerated, do not modify it directly
    * https://github.com/nexpid/BunnyPlugins/tree/${branch}/${file}
${mdNoteFlavors[flavor][1]}`;

/** @type {string} */
export const branch = execSync("git branch --show-current").toString().trim();
export const isDevBranch = branch !== "main";

export const isDev =
    process.argv.includes("-d") || process.argv.includes("--dev");

/** @type {import("prettier").Options} */
export const prettierOptions = {
    // .editorconfig isn't properly parsed by prettier, so I have to write
    // the rules myself here manually
    endOfLine: "lf",
    tabWidth: 4,
    printWidth: 80,
    bracketSameLine: true,
    arrowParens: "avoid",
};

/** @type {import("prettier").Options} */
export const markdownPrettierOptions = {
    ...prettierOptions,
    tabWidth: 2,
};

/**
 * @param {number} count
 * @param {string} singular
 * @param {string} plural
 */
export const plural = (count, singular, plural) =>
    count === 1 ? singular : plural;
